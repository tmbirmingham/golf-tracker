<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Round complete — Golf Tracker</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
<body>
  <h1>⛳ Round complete</h1>

  {% if sent %}
    <p class="sent">Your round summary has been sent to your email.</p>
    <p class="total">Total score: <strong>{{ total }}</strong></p>
    {% if total_par %}
    <p class="to-par">
      {% if to_par > 0 %}+{{ to_par }}{% elif to_par < 0 %}{{ to_par }}{% else %}Even{% endif %} 
      (Par {{ total_par }})
    </p>
    {% endif %}
  {% else %}
    {% if course_info %}
    <p class="course-name">{{ course_info.name }}</p>
    {% endif %}
    
    <p class="total">Total score: {{ total }}</p>
    {% if total_par %}
    <p class="to-par">
      {% if to_par > 0 %}+{{ to_par }}{% elif to_par < 0 %}{{ to_par }}{% else %}Even{% endif %} 
      (Par {{ total_par }})
    </p>
    {% endif %}

    {% if scores_list %}
    <h2>Scorecard</h2>
    <div class="scores">
      {% for i in range(0, scores_list|length, 9) %}
        {% set row_len = [9, scores_list|length - i]|min %}
        {# Labels row #}
        {% for j in range(i + 1, i + row_len + 1) %}
          <span class="label">{{ j }}</span>
        {% endfor %}
        {% for j in range(row_len, 9) %}
          <span class="label">&nbsp;</span>
        {% endfor %}

        {# Scores row #}
        {% for j in range(i, i + row_len) %}
          <span>{{ scores_list[j] }}</span>
        {% endfor %}
        {% for j in range(row_len, 9) %}
          <span>&nbsp;</span>
        {% endfor %}
      {% endfor %}
    </div>
    {% endif %}

    {% if gir_count is defined or fairway_total is defined or total_putts is defined %}
    <h2>Statistics</h2>
    <div class="stats-grid">
      {% if gir_count is defined %}
      <div class="stat-box">
        <div class="stat-value">{{ gir_count }}/{{ scores_list|length }}</div>
        <div class="stat-label">Greens in Regulation</div>
      </div>
      {% endif %}
      {% if total_putts is defined %}
      <div class="stat-box">
        <div class="stat-value">{{ total_putts }}</div>
        <div class="stat-label">Total Putts ({{ putts_avg }} avg)</div>
      </div>
      {% endif %}
      {% if fairway_total is defined and fairway_total > 0 %}
      <div class="stat-box">
        <div class="stat-value">{{ fairway_hit }}/{{ fairway_total }}</div>
        <div class="stat-label">Fairways Hit</div>
      </div>
      {% endif %}
      {% if fairway_left is defined and fairway_left > 0 %}
      <div class="stat-box">
        <div class="stat-value">{{ fairway_left }}</div>
        <div class="stat-label">Missed Left</div>
      </div>
      {% endif %}
      {% if fairway_right is defined and fairway_right > 0 %}
      <div class="stat-box">
        <div class="stat-value">{{ fairway_right }}</div>
        <div class="stat-label">Missed Right</div>
      </div>
      {% endif %}
    </div>
    {% endif %}

    <h2>Email Summary</h2>
    <p>Enter your email to receive a detailed summary:</p>
    {% if error %}<p class="error">{{ error }}</p>{% endif %}

    <form method="POST">
      <label for="email">Email</label>
      <input type="email" id="email" name="email" placeholder="you@example.com" required autofocus>
      <button type="submit">Send my results</button>
    </form>
  {% endif %}
</body>
</html>
